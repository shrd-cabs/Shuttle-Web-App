<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHRD Shuttle Bus Booking System</title>
    <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <img src="https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/d9292c3a-fe4c-4df4-be25-3ce0b0f6d61e" alt="Shri Radhey Logo" class="logo-img">
                <div>
                    <h1 style="margin: 0; font-size: 2.2em;">SHRD Shuttle Booking</h1>
                    <p style="margin: 5px 0; font-size: 1em;">Shri Radhey Travel Services</p>
                </div>
            </div>
            <button class="logout-btn" id="logoutBtn" style="display: none;" onclick="logout()">Logout</button>
        </div>

        <!-- LOGIN SECTION -->
        <div class="login-section active" id="loginSection">
            <div class="login-form">
                <h2 style="margin-bottom: 30px; text-align: center; color: #333;">Welcome Back!</h2>
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" onclick="login()">Login</button>
                <p style="text-align: center; margin-top: 15px; color: #666;">
                    Don't have an account? <a href="#" onclick="toggleSignup()" style="color: #6B46C1; cursor: pointer; font-weight: 600;">Sign up here</a>
                </p>

                <div id="signupForm" style="display: none; margin-top: 20px; border-top: 1px solid #ddd; padding-top: 20px;">
                    <h3 style="margin-bottom: 20px;">Create Account</h3>
                    <div class="form-group">
                        <label for="signupName">Full Name</label>
                        <input type="text" id="signupName" placeholder="Enter your name">
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email Address</label>
                        <input type="email" id="signupEmail" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="signupPhone">Phone Number</label>
                        <input type="tel" id="signupPhone" placeholder="Enter your phone">
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" placeholder="Create password">
                    </div>
                    <button class="btn btn-primary" onclick="signup()">Create Account</button>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT (Hidden until login) -->
        <div id="mainContent" style="display: none;">
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="booking">Book Seat</button>
                <button class="nav-tab" data-tab="mytrips">My Trips</button>
                <button class="nav-tab" data-tab="cancel">Cancel Booking</button>
                <button class="nav-tab" data-tab="admin">Admin Panel</button>
            </div>

            <!-- BOOKING SECTION -->
            <div class="content-section active" id="bookingSection">
                <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Select Your Seat</h2>
                
                <div class="booking-form">
                    <div class="form-group">
                        <label for="tripDate">Trip Date</label>
                        <input type="date" id="tripDate">
                    </div>
                    <div class="form-group">
                        <label for="tripTime">Departure Time</label>
                        <select id="tripTime">
                            <option>6:00 AM</option>
                            <option>9:00 AM</option>
                            <option>12:00 PM</option>
                            <option>3:00 PM</option>
                            <option>6:00 PM</option>
                            <option>9:00 PM</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="route">Route</label>
                        <select id="route">
                            <option>Delhi - Gurgaon</option>
                            <option>Delhi - Noida</option>
                            <option>Delhi - Greater Noida</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center; margin: 20px 0;">
                    <h3>Select Your Seats (Tap a seat)</h3>
                    <div class="bus-layout" id="busLayout"></div>
                </div>

                <div class="booking-details">
                    <h3>Booking Summary</h3>
                    <div class="detail-row">
                        <strong>Selected Seats:</strong>
                        <span id="selectedSeatsDisplay">None</span>
                    </div>
                    <div class="detail-row">
                        <strong>Trip Date:</strong>
                        <span id="dateDisplay">Not selected</span>
                    </div>
                    <div class="detail-row">
                        <strong>Departure Time:</strong>
                        <span id="timeDisplay">Not selected</span>
                    </div>
                    <div class="detail-row">
                        <strong>Route:</strong>
                        <span id="routeDisplay">Not selected</span>
                    </div>
                </div>

                <div id="bookingAlert" class="alert"></div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="openPaymentModal()">Proceed to Payment</button>
                    <button class="btn btn-secondary" onclick="resetBooking()">Clear Selection</button>
                </div>
            </div>

            <!-- MY TRIPS SECTION -->
            <div class="content-section" id="myTripsSection">
                <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Your Bookings</h2>
                <div class="my-trips" id="myTripsList">
                    <p style="text-align: center; color: #999;">No bookings found. Start by booking a seat!</p>
                </div>
            </div>

            <!-- CANCEL SECTION -->
            <div class="content-section" id="cancelSection">
                <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Cancel Booking</h2>
                <div class="booking-form">
                    <div class="form-group">
                        <label for="cancelBookingId">Booking ID</label>
                        <input type="text" id="cancelBookingId" placeholder="Enter your booking ID">
                        <div class="error-text" id="cancelError"></div>
                    </div>
                </div>
                <div id="cancelAlert" class="alert"></div>
                <div class="button-group">
                    <button class="btn btn-danger" onclick="cancelBooking()">Cancel Booking</button>
                    <button class="btn btn-secondary" onclick="clearCancelForm()">Clear</button>
                </div>
            </div>

            <!-- ADMIN PANEL SECTION -->
            <div class="content-section" id="adminSection">
                <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Google Sheets Integration</h2>
                
                <div class="booking-form">
                    <div style="background: #f0f8ff; padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #6B46C1;">
                        <h3 style="color: #6B46C1; margin-bottom: 15px;">üìä Setup Instructions</h3>
                        <ol style="color: #666; line-height: 2; padding-left: 20px;">
                            <li>Create a Google Sheet with tabs: <strong>Bookings</strong>, <strong>Users</strong>, <strong>Routes</strong>, <strong>Analytics</strong></li>
                            <li>Get your <strong>Google Sheets API Key</strong> from Google Cloud Console</li>
                            <li>Copy your <strong>Spreadsheet ID</strong> from the sheet URL</li>
                            <li>Enable <strong>Google Sheets API</strong> in your Google Cloud project</li>
                            <li>Make the sheet accessible (Share ‚Üí Anyone with link can edit)</li>
                        </ol>
                    </div>

                    <div class="form-group">
                        <label for="apiKey">üîë Google Sheets API Key</label>
                        <input type="text" id="apiKey" placeholder="Enter your API Key (AIzaSy...)">
                        <small style="color: #999; font-size: 0.85em;">Get from: Google Cloud Console ‚Üí APIs & Services ‚Üí Credentials</small>
                    </div>

                    <div class="form-group">
                        <label for="spreadsheetId">üìÑ Spreadsheet ID</label>
                        <input type="text" id="spreadsheetId" placeholder="Enter Spreadsheet ID from URL">
                        <small style="color: #999; font-size: 0.85em;">Found in URL: docs.google.com/spreadsheets/d/<strong>[THIS_PART]</strong>/edit</small>
                    </div>

                    <div class="form-group">
                        <label for="sheetNames">üìã Sheet Tab Names (comma-separated)</label>
                        <input type="text" id="sheetNames" placeholder="Bookings, Users, Routes, Analytics" value="Bookings, Users, Routes, Analytics">
                    </div>

                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107;">
                        <p style="color: #856404; margin: 0; font-size: 0.9em;">
                            ‚ö†Ô∏è <strong>Important:</strong> Your API credentials will be stored locally in your browser. Keep your API key secure!
                        </p>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-primary" onclick="saveGoogleSheetsConfig()">üíæ Save Configuration</button>
                        <button class="btn btn-secondary" onclick="testGoogleSheetsConnection()">üîó Test Connection</button>
                    </div>

                    <div id="adminAlert" class="alert" style="margin-top: 20px;"></div>

                    <div id="connectionStatus" style="display: none; margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px;">
                        <h3 style="color: #333; margin-bottom: 15px;">üìä Integration Status</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                                <p style="color: #999; font-size: 0.85em; margin-bottom: 5px;">API Status</p>
                                <p id="apiStatus" style="font-weight: bold; color: #6B46C1; font-size: 1.2em;">Not Connected</p>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                                <p style="color: #999; font-size: 0.85em; margin-bottom: 5px;">Last Sync</p>
                                <p id="lastSync" style="font-weight: bold; color: #6B46C1; font-size: 1.2em;">Never</p>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px;">
                        <h3 style="color: #333; margin-bottom: 15px;">üîÑ Manual Sync Actions</h3>
                        <div class="button-group">
                            <button class="btn btn-secondary" onclick="syncAllBookingsToSheets()">üì§ Sync All Bookings</button>
                            <button class="btn btn-secondary" onclick="syncAllUsersToSheets()">üë• Sync All Users</button>
                        </div>
                        <div class="button-group" style="margin-top: 10px;">
                            <button class="btn btn-secondary" onclick="importRoutesFromSheets()">üì• Import Routes</button>
                            <button class="btn btn-secondary" onclick="generateAnalytics()">üìä Generate Analytics</button>
                        </div>
                    </div>

                    <div style="margin-top: 30px; padding: 20px; background: #e8f5e9; border-radius: 8px;">
                        <h3 style="color: #2e7d32; margin-bottom: 15px;">‚ú® What This Integration Does</h3>
                        <ul style="color: #666; line-height: 2;">
                            <li>‚úÖ <strong>Auto-sync bookings</strong> to Google Sheets in real-time</li>
                            <li>‚úÖ <strong>Backup user data</strong> to cloud spreadsheet</li>
                            <li>‚úÖ <strong>Import routes & pricing</strong> from Google Sheets</li>
                            <li>‚úÖ <strong>Generate analytics</strong> (revenue, seat occupancy, popular routes)</li>
                            <li>‚úÖ <strong>Email notifications</strong> with booking confirmations</li>
                            <li>‚úÖ <strong>Dashboard insights</strong> for business decisions</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>¬© 2026 SHRD Transport Services. All rights reserved. | Secure Online Booking Platform</p>
        </div>
    </div>

    <!-- PAYMENT MODAL -->
    <div id="paymentModal" class="payment-modal">
        <div class="payment-content">
            <h2>Complete Payment</h2>
            <div class="payment-info">
                <p id="paymentRoute">Route: Not selected</p>
                <p id="paymentDate">Date: Not selected</p>
                <p id="paymentTime">Time: Not selected</p>
                <p id="paymentSeats">Seats: Not selected</p>
            </div>
            <div class="price-display">‚Çπ<span id="totalPrice">0</span></div>
            <div class="payment-methods">
                <div class="payment-method">
                    <input type="radio" id="upi" name="paymentMethod" value="UPI" checked>
                    <label for="upi">üí≥ UPI Payment</label>
                </div>
                <div class="payment-method">
                    <input type="radio" id="card" name="paymentMethod" value="Credit/Debit Card">
                    <label for="card">üè¶ Credit/Debit Card</label>
                </div>
                <div class="payment-method">
                    <input type="radio" id="wallet" name="paymentMethod" value="Digital Wallet">
                    <label for="wallet">üì± Digital Wallet</label>
                </div>
                <div class="payment-method">
                    <input type="radio" id="netbanking" name="paymentMethod" value="Net Banking">
                    <label for="netbanking">üèõÔ∏è Net Banking</label>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn-pay" onclick="processPayment()">Pay Now</button>
                <button class="btn-cancel" onclick="closePaymentModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- CONFIRMATION MODAL -->
    <div id="confirmationModal" class="confirmation-modal">
        <div class="confirmation-content">
            <div class="confirmation-icon">‚úì</div>
            <h2>Booking Confirmed!</h2>
            <p>Your shuttle booking has been successfully completed.</p>
            <div class="confirmation-details">
                <p><strong>Booking ID:</strong> <span id="confirmBookingId"></span></p>
                <p><strong>Email:</strong> <span id="confirmEmail"></span></p>
                <p><strong>Route:</strong> <span id="confirmRoute"></span></p>
                <p><strong>Date:</strong> <span id="confirmDate"></span></p>
                <p><strong>Time:</strong> <span id="confirmTime"></span></p>
                <p><strong>Seats:</strong> <span id="confirmSeats"></span></p>
                <p><strong>Amount Paid:</strong> ‚Çπ<span id="confirmAmount"></span></p>
                <p style="margin-top: 15px; font-size: 0.95em; color: #666;">A confirmation email has been sent to your registered email address.</p>
            </div>
            <button class="close-confirmation" onclick="closeConfirmationModal()">Done</button>
        </div>
    </div>
    <script src="assets/script.js"></script>
</body>
</html>
